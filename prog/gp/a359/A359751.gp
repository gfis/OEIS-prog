/* source=https://oeis.org/A359751 lang=pari curno=1 type=isok rev=43 offset=1 bfimax=2908 */
isok(n) = { if(n == 1, return(0)); my(i, factorials, e, res, v); f = factor(n); if(prime(#f~) != f[#f~, 1], return(0); ); if(f[,2] != vecsort(f[,2],,4), return(0); ); factorials = List(); e = List(); res = List(); for(i = 2, oo, v = valuation(n, i!); if(v > 0, listput(factorials, i!); listput(e, v); , break ) ); forvec(x = vector(#e-1, i, [0, e[i+1]]), c = prod(i = 1, #e-1, factorials[i+1]^x[i]); if(c <= n && denominator(n/c) == 1&& 1 << logint(n/c, 2) == n/c, listput(res, concat([valuation(n/c, 2)], x)) ) ); for(i = 1, #e, p = 1; for(j = 1, #res, p*=res[j][i]; ); if(p != 0, return(0) ) ); 1 };
