\\ source=https://oeis.org/A166904 lang=pari curno=1 type=an  rev=2 offset=0 bfimax=17 timeout=4 status=pass
{a(n)=local(F=x, M, N, P); M=matrix(n+2, n+2, r, c, F=x;for(i=1, r+c-2, F=subst(F, x, x+x^2+x*O(x^(n+2)))); polcoeff(F, c)); N=matrix(n+1, n+1, r, c, F=x;for(i=1, r, F=subst(F, x, x+x^2+x*O(x^(n+3)))); polcoeff(F, c)); P=matrix(n+1, n+1, r, c, M[r+1, c]); M=(P~*N~^-1); sum(k=1,n+1,M[n+1,k])};
